# Docker 原理

[toc]



## 谈谈虚拟化技术

虚拟化技术需要解决这些问题：

- 制造虚拟环境，隔离同一物理平台中的不同应用程序。
- 控制硬件资源的分配。



## Dockers技术实现

Docker 的实现，主要归结于三大技术：

- 命名空间 ( Namespaces ) 
- 控制组 ( Control Groups ) 
- 联合文件系统 ( Union File System ) 



### 基于Namespace实现进程隔离

Docker为每个容器分配了独立的PID namespace。这意味着每个容器都有其独立的进程空间，看不到其他容器的进程。容器内的进程在命名空间内运行，而不会影响主机或其他容器。



### 基于Control Groups实现硬件资源隔离

资源控制组（Control Croups）的作用是实现硬件资源的隔离，控制硬件资源的分配。



### 基于联合文件系统管理文件资源

联合文件系统 ( Union File System ) 是一种能够同时挂载不同实际文件或文件夹到同一目录，形成一种**联合文件结构**的文件系统。联合文件系统本身与虚拟化并无太大的关系。

> 在Linux中，挂载（Mount）是指将一个文件系统连接到指定的目录上，使得该目录成为文件系统的访问入口。通过挂载，可以使得文件系统中的文件和目录可在特定目录下进行读写操作。具体而言，挂载操作是将设备文件中的顶级目录连接到Linux根目录下的某一目录（最好是空目录），访问此目录就等同于访问设备文件。需要注意的是，并不是根目录下任何一个目录都可以作为挂载点，由于挂载操作会使得原有目录中文件被隐藏，因此根目录以及系统原有目录都不要作为挂载点，会造成系统异常甚至崩溃，挂载点最好是新建的空目录。
>
> 速记：将某文件系统挂载到某个空目录下。

文件系统的修改作为一次提交来一层层的叠加，上层文件可以共用下层文件，从而节约了空间。

其中最上面的一层叫做**容器层**（**可读可写**），下面的所有层叫做**镜像层**（**可读、不可写**）。



## Docker核心组成

Docker中有四大组成对象：

- 镜像（Image）
- 容器（Container）
- 网络（Network）
- 数据卷（Volume）



### 镜像

简单来说，docker镜像就是软件包。它为运行的容器提供一个独立的文件系统（叫做联合文件系统）、运行时需要的所有软件、环境、依赖......



![img](https://ask.qcloudimg.com/http-save/developer-news/h2qjlnki50.png?imageView2/2/w/1620)



### 容器

- 容器是宿主机上的一个进程，它与其他<u>容器进程</u>隔离。
- 容器是处于**运行状态**的镜像。



### 网络



### 数据卷

